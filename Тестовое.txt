Тестовое задание на должность «Разработчик ETL»
В бакет на S3 в будние дни по расписанию кладется файл csv с содержимым: автомобиль, стоимость в иностранной валюте, дата актуальности всего файла. 
Характеристики автомобилей: марка, модель, объем двигателя, год выпуска. С каждым файлом информация может изменяться: добавляются строки для других автомобилей, удаляются строки для уже бывших или же изменяется стоимость на них.
Написать DAG для Apache Airflow, который переводит стоимость в рублевый эквивалент по актуальному на дату создания файла курсу ЦБ и складывает эту информацию в таблицу в GreenPlum. 
DAG должен работать с понедельника по субботу, но не по воскресеньям. В субботу необходимо использовать курс валют, актуальный на минувшую пятницу.
Курс валют можно скачать с сайта ЦБ на нужную дату https://cbr.ru/scripts/xml_daily.asp?date_req=29/05/2025 

Мне необходимо изменить этот даг, чтоб в нем было 3 основных таски:
1)	Название examination_s3 (параллельно examination_cbr):
- Проверяет, есть ли .csv файл за сегодняшний день в бакете
- Если файл есть, то складывает файл в отдельный бакет s3 с изменением в названии файла (к названию cars_2025XXXX_”добавляется дата и время выполнения попытки дага”.csv) для историчности, 
парсит файл (уже из нового бакета) и складывает данные в таблицу car_prices_day (это временная таблица и она затирается после завершения дага)
- Если файла нет, то отправляется соответствующее оповещение в тг («Файл XX.csv отсутствует») и следующая попытка происходит через 5 минут.
2)	Название examination_cbr (параллельно examination_s3):
- Проверяет, есть ли данные по курсу валют на вышеупомянутом сайте за текущую дату (В субботу необходимо использовать курс валют, актуальный на минувшую пятницу).
- Если данные есть, то загружает их currency_rate_day (это временная таблица и она затирается после завершения дага)
- Если данных нет, то отправляется соответствующее оповещение в тг («Данных по курсу валют за «дата выполнения дага» нет») и следующая попытка происходит через 5 минут.
3)	Название association_car_cbr (выполняется после первых 2х):
- Данные из car_prices_day и currency_rate_day сверяются с данными в таблице car_prices (это уже итоговая таблица и она не затирается даже если докер перезапустить)
- Если такие данные уже лежат в таблице, то отправляется соответствующее оповещение в тг («Свежих данных не появилось»)
- Если таких данных нет или данных разнятся, то: 
    . данные в таблице car_prices обновляются и отправляется соответствующее оповещение в тг.
    . данные из таблицы car_prices_day перекладываются в таблицу car_prices_arch
    . данные из таблицы currency_rate_day перекладываются в таблицу currency_rate_arch

Так же добавь изменения в файл init-db.sql, чтобы там были необходимые таблицы(ГЛАВНОЕ чтобы в каждой таблице были поля с датой актуальности файла .csv(для таблиц связанных с s3)/валют(для таблиц связанных с сайтом ЦБРФ) и с датой и временем выполнения попытки дага).
Может быть понадобится внести изменеия в файл docker-compose.yaml, чтобы при каждом запуске докера не создавать бакеты и тд.
Напиши какие еще сопутствующие изменения будут нужны в других файлах для правильного выполнения дага.
Мне нужны полные(без сокращений) скрипты с комментариями.
